SELECT DISTINCT CATEGORY.CATEGORY_NAME,
	CUSTOMER.COUNTRY,
	SUM(SALES) OVER(PARTITION BY ORDERSALE.CATEGORY_ID,
    CUSTOMER.COUNTRY) TOTAL_SALES
FROM FACTORDERSALES ORDERSALE
JOIN DIMCUSTOMERS CUSTOMER ON ORDERSALE.CUSTOMER_ID = CUSTOMER.ID
JOIN DIMCATEGORIES CATEGORY ON ORDERSALE.CATEGORY_ID = CATEGORY.ID
ORDER BY TOTAL_SALES DESC;